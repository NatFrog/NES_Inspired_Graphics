
module ppu_palette(
	input clk,
	input [4:0] pal_addr,
	input palette_en,
	output [7:0] color_out  //color taken from pallette
	);

	//In NES, it's usually static 32 byte ram.
	reg [7:0] palette_mem [31:0];
	reg [7:0] color;
	

	initial begin
		//Store palette colors- we can preload whatever colors we need initially.
		//$readmemh("PPU/palette.mem", palette_mem);   //read the pallete data into memory from a .mem file
		 palette_mem[0]  = 8'h22; palette_mem[1]  = 8'h29; palette_mem[2]  = 8'h1A; palette_mem[3]  = 8'h0F; // Palette 0
		 palette_mem[4]  = 8'h00; palette_mem[5]  = 8'h10; palette_mem[6]  = 8'h20; palette_mem[7]  = 8'h30; // Palette 1
		 palette_mem[8]  = 8'h02; palette_mem[9]  = 8'h12; palette_mem[10] = 8'h22; palette_mem[11] = 8'h32; // Palette 2
		 palette_mem[12] = 8'h03; palette_mem[13] = 8'h13; palette_mem[14] = 8'h23; palette_mem[15] = 8'h33; // Palette 3
		 palette_mem[16] = 8'h04; palette_mem[17] = 8'h14; palette_mem[18] = 8'h24; palette_mem[19] = 8'h34; // Palette 4
		 palette_mem[20] = 8'h05; palette_mem[21] = 8'h15; palette_mem[22] = 8'h25; palette_mem[23] = 8'h35; // Palette 5
		 palette_mem[24] = 8'h06; palette_mem[25] = 8'h16; palette_mem[26] = 8'h26; palette_mem[27] = 8'h36; // Palette 6
		 palette_mem[28] = 8'h07; palette_mem[29] = 8'h17; palette_mem[30] = 8'h27; palette_mem[31] = 8'h37; // Palette 7
	end
	
	always @(posedge clk) begin
		begin
			if(palette_en)
				color = palette_mem[pal_addr];
			else
				color <= palette_mem[0]; //default color
		end
	end
	
	assign color_out = (palette_en) ? color : 8'hzz;
	
endmodule
